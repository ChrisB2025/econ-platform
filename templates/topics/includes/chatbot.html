{% if chatbot_enabled %}
<!-- Chatbot Toggle Button -->
<button id="chatbot-toggle" class="chatbot-toggle" title="Ask the Teaching Assistant">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <span class="toggle-label">Ask AI</span>
</button>

<!-- Chatbot Container -->
<div id="chatbot-container" class="chatbot-container" data-topic-context="{{ topic.name|default:'' }}{% if school %} - {{ school.name }} perspective{% endif %}">
    <div class="chatbot-header">
        <h3>Economics Teaching Assistant</h3>
        <span class="chatbot-tier">Tier 3: AI Generated</span>
        <button id="chatbot-close" class="chatbot-close" title="Close">&times;</button>
    </div>

    <div id="chatbot-messages" class="chatbot-messages">
        <!-- Messages will be added here by JavaScript -->
    </div>

    <form id="chatbot-form" class="chatbot-form">
        {% csrf_token %}
        <input
            type="text"
            id="chatbot-input"
            class="chatbot-input"
            placeholder="Ask about inflation, schools of thought..."
            autocomplete="off"
        >
        <button type="submit" id="chatbot-send" class="chatbot-send">Send</button>
    </form>
</div>
{% else %}
<!-- Chatbot not configured -->
<div id="chatbot-container" class="chatbot-container chatbot-disabled">
    <p class="chatbot-disabled-message">
        Teaching assistant is not available. Set ANTHROPIC_API_KEY to enable.
    </p>
</div>
{% endif %}
