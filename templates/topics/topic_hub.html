{% extends 'base.html' %}

{% block title %}{{ topic.name }} | Pluralist Economics{% endblock %}

{% block content %}
<div class="container">
    <!-- Topic Header -->
    <header class="topic-header">
        <h1>{{ topic.name }}</h1>
        <p class="content-tier tier-{{ topic.tier }}">
            {% if topic.tier == 1 %}Approved Reference Content
            {% elif topic.tier == 2 %}Platform Content
            {% else %}Generative Content{% endif %}
        </p>
    </header>

    <!-- School Navigation Tabs -->
    <nav class="school-nav">
        <ul class="school-tabs">
            <li class="school-tab active">
                <a href="{% url 'topics:topic_hub' topic.slug %}">
                    <span class="tab-label">Introduction</span>
                </a>
            </li>
            {% for school in schools %}
            <li class="school-tab" style="--school-color: {{ school.color }}">
                <a href="{% url 'topics:explanation' topic.slug school.slug %}">
                    <span class="tab-label">{{ school.name }}</span>
                </a>
            </li>
            {% endfor %}
        </ul>
    </nav>

    <!-- Content Layout: Main + Sidebar -->
    <div class="content-with-sidebar">
        <!-- Main Content Area -->
        <article class="topic-content">
            <div class="introduction">
                {{ introduction_html|safe }}
            </div>

            <!-- School Cards Grid -->
            <section class="schools-overview">
                <h2>Schools of Thought</h2>
                <p class="section-intro">
                    Select a perspective below to explore how that school of thought explains {{ topic.name|lower }}.
                </p>

                <div class="school-cards">
                    {% for explanation in explanations %}
                    <a href="{% url 'topics:explanation' topic.slug explanation.school.slug %}"
                       class="school-card"
                       style="--school-color: {{ explanation.school.color }}">
                        <h3>{{ explanation.school.name }}</h3>
                        <p class="school-description">{{ explanation.school.short_description }}</p>
                        <span class="card-cta">Read explanation</span>
                    </a>
                    {% endfor %}
                </div>
            </section>
        </article>

        <!-- Sidebar Navigation -->
        <aside class="topic-sidebar">
            <div class="sidebar-section">
                <h3>Explore</h3>
                <ul class="sidebar-links">
                    <li><a href="{% url 'topics:comparisons' topic.slug %}">Compare Schools</a></li>
                    <li><a href="{% url 'topics:materials' topic.slug %}">Teaching Materials</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3>Quick Access</h3>
                <ul class="sidebar-links">
                    {% for school in schools %}
                    <li>
                        <a href="{% url 'topics:explanation' topic.slug school.slug %}"
                           style="border-left-color: {{ school.color }}">
                            {{ school.name }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </aside>
    </div>
</div>
{% endblock %}
